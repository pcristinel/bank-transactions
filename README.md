# Spring Boot Rest API that manages transactions information

## Tech Stack
- IDE: IntelliJ IDEA Community Edition (2022.1.1)
- Java 17
    - [Java Text Blocks](https://www.baeldung.com/java-text-blocks)
    - [Switch Statement](https://medium.com/@javatechie/the-evolution-of-switch-statement-from-java-7-to-java-17-4b5eee8d29b7)
- Spring Boot: 2.7.0
     - Spring Data
     - Spring DevTools
- MapStruct
- Lombok
- SpringDoc OpenApi
- Maven 3.8.4
- H2 Database

## Prerequisites to test/run the application
- Java 17
- Maven 3.8.4

## Updated Requirements
While I was developing this project, I had to update the requirements as I encountered some issues.
1. reference (optional): The transaction unique reference number in our system. ~~If not present, the system will generate one.~~ **The
     reference number is the ID of the transaction, and it will ALWAYS be automatically generated by the system. If we allow the 
   client to provide
     a reference number we may have inconsistency in our database or if the client provides an already existing reference in our database
     it will give an error back.**

## Run tests
You can use your favorite IDE to run the tests or use the following command:
```shell
mvn test
```

## Run the application
1. Clone the repository
2. In the cloned folder repository, run the following command:
```shell
mvn spring-boot:run
```

## Available endpoints
Since the project uses SpringDoc OpenApi, we can see the available endpoints at the following link:

[http://localhost:8080/swagger-ui/index.html](http://localhost:8080/swagger-ui/index.html)

[Example of the first time you access Swagger UI](./readme-resources/img/01-swagger-ui.png)
![Example of the first time you access Swagger UI](./readme-resources/img/01-swagger-ui.png)

### Examples to call the endpoints
You can use the HTTP client of your choice to call the endpoints. In the next examples I will use Postman to perform the requests.

Using the [import feature of Postman](https://learning.postman.com/docs/getting-started/importing-and-exporting-data/) you can import the OpenAPI definition from the following link: [http://localhost:8080/v3/api-docs](http://localhost:8080/v3/api-docs)

#### Create a new transaction
- `POST /api/v1/transactions`
```json
{
	"account_iban": "ES3730046235659186738712",
	"date": "2022-08-01T17:30:42.000Z",
	"amount": 68.18,
	"fee": 3.18,
	"description": "Restaurant payment"
}
```

[Example calling POST /api/v1/transactions](./readme-resources/img/02-create-transaction-example01.png)
![Example calling POST /api/v1/transactions](./readme-resources/img/02-create-transaction-example01.png)

#### Find transactions by account iban and sort by field and order
In order to have some data in our database when the application starts, I used a CommandLineRunner to create some transactions.
The iban account that will be used to perform the filtering and sorting is: `ES3730046235659186738712`
You could also use the [Create a new transaction](#create-a-new-transaction) endpoint to create a new transaction.

- `GET /api/v1/transactions/search?account_iban=ES3730046235659186738712&sortField=amount&sortOrder=DESC`

[Example calling GET /api/v1/transactions/search](./readme-resources/img/03-find-transactions-by-account-iban.png)
![Example calling GET /api/v1/transactions/search](./readme-resources/img/03-find-transactions-by-account-iban.png)


#### Transaction status